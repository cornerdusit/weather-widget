<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tenor GIF Box</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000000; /* Changed to black background */
        }
        .gif-container {
            width: 300px; /* Fixed width */
            height: 300px; /* Fixed height */
            overflow: hidden; /* Hide anything outside the box */
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #ffffff; /* White background for the box */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Subtle shadow */
            opacity: 0.5; /* Added 50% opacity */
        }
        .gif-container video { /* Changed img to video */
            max-width: 100%; /* Ensure video fits within the container */
            max-height: 100%; /* Ensure video fits within the container */
            object-fit: contain; /* Maintain aspect ratio and fit inside */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-black p-4">
    <div id="gifBox" class="gif-container rounded-lg p-2">
        <p class="text-gray-500 text-center">Loading Video...</p>
    </div>

    <script>
        // Self-executing anonymous function to encapsulate variables and prevent global pollution
        (function() {
            // Tenor API details
            const TENOR_API_KEY = "AIzaSyBWke0nAfAG01Zb5br2Kjsu11Z6OQGtvDU"; // Your Tenor API Key
            const SEARCH_QUERY = "sexy women"; // Search term for videos
            const GIF_BOX_ID = "gifBox"; // ID of the HTML element to display the video
            const FETCH_LIMIT = 500; // Number of videos to fetch to enable random selection

            // Get the video container element
            const gifBox = document.getElementById(GIF_BOX_ID);

            /**
             * Fetches a random MP4 video from the Tenor API based on the search query.
             * It fetches multiple videos and then picks one randomly from the results.
             * @returns {Promise<string|null>} A promise that resolves to the video URL or null if an error occurs.
             */
            async function fetchRandomVideo() { // Renamed function for clarity
                // Construct the API URL. Requesting 'mp4' media format.
                const url = `https://tenor.googleapis.com/v2/search?q=${encodeURIComponent(SEARCH_QUERY)}&key=${TENOR_API_KEY}&client_key=my_app_name&limit=${FETCH_LIMIT}&media_filter=mp4&contentfilter=off`;

                try {
                    // Make the fetch request to the Tenor API
                    const response = await fetch(url);

                    // Check if the request was successful
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    // Parse the JSON response
                    const data = await response.json();

                    // Check if results are available
                    if (data.results && data.results.length > 0) {
                        // Pick a random index from the fetched results
                        const randomIndex = Math.floor(Math.random() * data.results.length);
                        const randomItem = data.results[randomIndex];

                        // Ensure the randomly selected item has an 'mp4' media format
                        if (randomItem.media_formats && randomItem.media_formats.mp4) {
                            return randomItem.media_formats.mp4.url; // Return the MP4 URL
                        } else {
                            console.warn("Randomly selected item has no 'mp4' media format.");
                            return null;
                        }
                    } else {
                        console.warn("No videos found for the given query.");
                        return null;
                    }
                } catch (error) {
                    console.error("Error fetching video:", error);
                    return null;
                }
            }

            /**
             * Displays a video in the specified HTML container.
             * @param {string|null} videoUrl The URL of the video to display. If null, displays an error message.
             */
            function displayVideo(videoUrl) { // Renamed function for clarity
                // Clear any existing content in the box
                gifBox.innerHTML = ''; // Keep gifBox ID for consistency, but it now holds a video

                if (videoUrl) {
                    // Create a video element instead of an image element
                    const video = document.createElement('video');
                    video.src = videoUrl;
                    video.alt = SEARCH_QUERY + " Video"; // Changed alt text
                    video.className = "rounded-md"; // Tailwind class for rounded corners
                    video.autoplay = true; // Autoplay the video
                    video.loop = true; // Loop the video
                    video.muted = true; // Mute the video to allow autoplay without user interaction requirement

                    // Add an onerror handler for broken videos
                    video.onerror = () => {
                        gifBox.innerHTML = '<p class="text-red-500 text-center">Failed to load video. Please try again.</p>';
                    };

                    // Append the video to the container
                    gifBox.appendChild(video);
                } else {
                    // Display a message if no video URL is provided or an error occurred
                    gifBox.innerHTML = '<p class="text-red-500 text-center">Could not load video. Check console for details.</p>';
                }
            }

            /**
             * Main function to update the video.
             */
            async function updateVideo() { // Renamed function for clarity
                gifBox.innerHTML = '<p class="text-gray-500 text-center">Loading new Video...</p>'; // Show loading message
                const videoUrl = await fetchRandomVideo();
                displayVideo(videoUrl);
            }

            // Initial video load when the page loads
            window.onload = updateVideo;

            // Set an interval to fetch and display a new video every 1 minute (60000 milliseconds)
            setInterval(updateVideo, 60000); // Changed refresh interval to 60000 milliseconds (1 minute)
        })();
    </script>
</body>
</html>
